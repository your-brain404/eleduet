import{_ as O,x as z,s as u,o as f,f as F,l as a,k as l,y as ie,z as ne,b as d,R as oe,P as le,C as I,D as ae,r as se,i as x,t as y,e as M,c as C,d as G,F as W,T as re,w as ce,q as de,m as ue,K as B,G as me,S as fe,H as he,L as ve,M as pe,U as _e,V as ge,W as q,Q as H,B as ye}from"./app-7e0eada9.js";import{V as Q,i as Y,p as be,P as Fe}from"./Pagination-a0f8d3e7.js";import{V as U,a as L}from"./VCol-881ced2b.js";import{a as R,V as N,S as K,T as $,f as ke,b as we}from"./VDivider-99007ce3.js";import{b as ee,V as Ce,c as Se,a as xe}from"./VCardTitle-612be7de.js";import{C as Pe,p as Ve}from"./Checkbox-e2b7c125.js";import je from"./formServiceModule-db70c938.js";import{V as Te}from"./VTextarea-6e3da498.js";const ze={components:{VRow:U,VCard:R,VCardText:Q,VCol:L,VBtn:N,SvgVue:K,TextField:$,VForm:ee},props:{imagesOnly:{type:Boolean,default:!1}},data(){return{file:[],loading:!1,valid:!0,rules:[e=>{let i=[];for(let c of e)c.size>25e6&&i.push(c.name);return i.length===0||`Pliki [${i.join(", ")}] nie powinny być większe niż 25 MB!`},e=>{if(!this.imagesOnly)return!0;let t=[];for(let i of e)Y(i.type)||t.push(i.name);return t.length===0||`Pliki [${t.join(", ")}] powinny być zdjęciami!`}]}},computed:{photoTypes(){return be.join(", ")}},methods:{submit(){if(!(this.file.length==0||!this.valid)){this.loading=!0;for(let e=0;e<this.file.length;e++){let t=new FormData;t.append("file",this.file[e]),z.post("/api/media/add",t).then(i=>{this.loading=!1,this.$emit("loadFiles"),this.file=[],this.$store.commit("toast","Pomyślnie dodano!")}).catch(i=>{this.loading=!1,console.log(i),this.$store.commit("toast","Coś poszło nie tak...")})}}}}},De=e=>(ie("data-v-f2072bf2"),e=e(),ne(),e),Oe=De(()=>d("span",null,"Wyślij",-1));function Ie(e,t,i,c,o,n){const m=u("text-field"),r=u("svg-vue"),s=u("v-btn"),h=u("v-form"),k=u("v-col"),S=u("v-row"),w=u("v-card-text"),T=u("v-card");return f(),F(T,{flat:""},{default:a(()=>[l(w,null,{default:a(()=>[l(S,{class:"d-flex justify-content-center add-files-row"},{default:a(()=>[l(k,{lg:"4",sm:"12",md:"6"},{default:a(()=>[l(h,{ref:"form",modelValue:o.valid,"onUpdate:modelValue":t[1]||(t[1]=b=>o.valid=b),"lazy-validation":""},{default:a(()=>[l(m,{modelValue:o.file,"onUpdate:modelValue":t[0]||(t[0]=b=>o.file=b),multiple:"","show-size":"",counter:"",label:"Pliki",icon:"paperclip",rules:o.rules,type:"file",accept:i.imagesOnly?n.photoTypes:""},null,8,["modelValue","rules","accept"]),l(s,{disabled:o.loading||!o.valid||o.file.length===0,loading:o.loading,onClick:n.submit,class:"mt-3"},{icon:a(()=>[l(r,{icon:"check"})]),default:a(()=>[Oe]),_:1},8,["disabled","loading","onClick"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}const Ae=O(ze,[["render",Ie],["__scopeId","data-v-f2072bf2"]]);async function Ee(e){try{await navigator.clipboard.writeText(e),oe().commit("toast","Skopiowano link do schowka!")}catch(t){console.error(t)}}const Me={directives:{},components:{AddFiles:Ae,SvgVue:K,VCardText:Q,Picture:le,VRow:U,TextField:$,VCard:R,VCol:L,VBtn:N,Pagination:Fe},props:{value:{type:String},title:{type:String},imagesOnly:{type:Boolean,default:!1}},data(){return{modal:!1,tab:null,tabs:["Wybierz plik","Dodaj Nowe Pliki"],files:[],activeFile:0,multiple:!1,search:"",page:1,chosenFileColumnShow:!1,placeholder:"/storage/img/placeholder/250.png",settings:window.global.config.settings}},computed:{filteredFiles(){let e=[];for(let t of this.files)t.path.toLowerCase().includes(this.search.toLowerCase())&&e.push(t);return e.reverse().slice((this.page-1)*12,(this.page-1)*12+12)},chosenFile(){return this.files.find(e=>e.id==this.activeFile)||{}}},watch:{value:"setInitialActiveFile",files:"setInitialActiveFile",modal(e){document.querySelector("html").style.overflow=e?"hidden":""}},methods:{url:I,isPhoto:Y,formatFileSize:ke,copyToClipboard:Ee,existingPhotoPath:ae,toggleModal(){this.modal=!this.modal},setInitialActiveFile(){var e;this.files.length>0&&this.value&&(this.activeFile=(e=this.getFileByPath(this.value))==null?void 0:e.id)},clearActiveFile(){this.activeFile=0,this.$emit("input","")},isActiveFileDeleted(e){if(!this.value)return;this.files.find(i=>i.id==e&&e==this.activeFile)&&(this.$emit("input",""),this.$store.dispatch("FormService/updateDeletedFile"))},loadFiles(){z.get(`/api/media/${this.imagesOnly?"get_photos":"get_all"}`).then(e=>{this.files=e.data})},deleteFile(e){confirm("Czy na pewno?")&&z.delete("/api/media/delete/"+e).then(()=>{this.isActiveFileDeleted(e),this.loadFiles(),this.chosenFileColumnShow=!1}).catch(t=>console.log(t))},getFileByPath(e){return this.files.find(t=>t.path===e)},sendFilePathToPlaceholder(){var t;let e=(t=this.chosenFile)==null?void 0:t.path;e&&this.$emit("input",e)},setFileClass(e){this.activeFile=e,this.chosenFileColumnShow=!0,console.log(this.chosenFileColumnShow),this.sendFilePathToPlaceholder()}},created(){this.loadFiles()}},Be={class:"file-picker__active-file-container"},Ue=["href"],Le={class:"file-picker-menu"},Re={class:"file-picker-menu__title"},Ne={class:"d-flex align-items-center flex-wrap"},Ke={class:"file-picker__modal-title"},$e={class:"mx-0"},Ge={class:"row mx-0 choose-file-row"},We={key:0,class:"position-relative"},qe={key:0,class:"mask file-picker__photo-mask"},He=["title"],Ze={key:0,class:"chosen-file-container"},Je={class:"d-flex justify-content-between align-items-center"},Xe=d("h4",null,"Wybrany plik:",-1),Qe={class:"chosen-file__parameter"},Ye=["href"],et=d("span",null,"PODGLĄD",-1),tt={style:{"word-break":"break-all"}},it={key:0},nt={key:1},ot=d("span",null,"KOPIUJ LINK",-1);function lt(e,t,i,c,o,n){const m=u("Picture"),r=u("svg-vue"),s=u("v-btn"),h=u("v-col"),k=u("text-field"),S=u("Pagination"),w=u("v-row"),T=u("v-card-text"),b=u("v-card"),A=u("AddFiles"),P=u("b-tab"),E=u("b-tabs"),v=u("b-modal"),p=se("b-tooltip");return f(),F(w,{justify:"center",class:"file-picker-component mt-5 mb-5 px-3"},{default:a(()=>[n.chosenFile.id||i.value?(f(),F(h,{key:0,class:"w-100 d-flex flex-column justify-content-between align-items-center px-0"},{default:a(()=>[n.isPhoto(n.chosenFile.type)?(f(),F(m,{key:0,width:"100%",src:i.value?n.url(i.value):o.placeholder},null,8,["src"])):x("",!0),d("div",Be,[d("a",{target:"_blank",href:n.url(i.value)},[d("div",null,y(i.value.split("/")[i.value.split("/").length-1]),1)],8,Ue),l(s,{onClick:n.clearActiveFile,"just-icon":""},{icon:a(()=>[l(r,{width:"24",height:"24",icon:"close"})]),_:1},8,["onClick"])]),l(s,{onClick:n.toggleModal,color:o.settings.first_color,class:"file-picker__modal-button"},{default:a(()=>[M(y(i.title?i.title:"Dodaj plik"),1)]),_:1},8,["onClick","color"])]),_:1})):x("",!0),l(v,{modelValue:o.modal,"onUpdate:modelValue":t[8]||(t[8]=_=>o.modal=_),"no-close-on-backdrop":"","no-close-on-esc":"",size:"xl","modal-class":"file-picker","hide-footer":"","hide-header":""},{default:a(()=>[l(b,null,{default:a(()=>[d("div",Le,[d("div",Re,[d("div",Ne,[d("div",Ke," FilePicker"+y(i.title?` - ${i.title}`:""),1),l(k,{class:"file-picker__search-input",label:"Szukaj",icon:"magnify",modelValue:o.search,"onUpdate:modelValue":t[0]||(t[0]=_=>o.search=_),onInput:e.searchPhoto,"no-validation":""},null,8,["modelValue","onInput"])]),l(s,{onClick:t[1]||(t[1]=_=>o.modal=!1),class:"file-picker-close","just-icon":""},{icon:a(()=>[l(r,{width:"24",height:"24",icon:"close"})]),_:1})]),l(E,{class:"file-picker__tabs",modelValue:o.tab,"onUpdate:modelValue":t[7]||(t[7]=_=>o.tab=_),"background-color":"primary",dark:""},{default:a(()=>[(f(!0),C(W,null,G(o.tabs,(_,D)=>(f(),F(P,{title:_,active:D==0,key:_},{default:a(()=>[D==0?(f(),F(b,{key:0},{default:a(()=>[l(T,null,{default:a(()=>[d("div",$e,[d("div",Ge,[l(h,{cols:"12",lg:"8",md:"8",style:{"align-items":"flex-end",display:"flex"}},{default:a(()=>[l(w,{class:"d-flex align-items-center pa-5 files-container"},{default:a(()=>[(f(!0),C(W,null,G(n.filteredFiles,g=>(f(),F(h,{class:"d-flex file-picker-col align-items-between flex-column",lg:"2",md:"3",sm:"4",cols:"6",key:g.id,onClick:At=>n.setFileClass(g.id)},{default:a(()=>[g.type.split("/")[0]=="image"?(f(),C("div",We,[l(re,{name:"fade"},{default:a(()=>[n.chosenFile&&n.chosenFile.id===g.id?(f(),C("div",qe)):x("",!0)]),_:2},1024),l(m,{classImg:"file-picker__photo",src:n.url(g.path)},null,8,["src"])])):ce((f(),C("div",{key:1,title:g.path.split("/")[1],class:"file-picker__set-file-button"},[l(s,{color:o.settings.first_color},{icon:a(()=>[l(r,{icon:"file"})]),default:a(()=>[d("span",null,y(g.path.split("/")[1]),1)]),_:2},1032,["color"])],8,He)),[[p,void 0,void 0,{hover:!0}]])]),_:2},1032,["onClick"]))),128)),l(h,{cols:"12",style:{"padding-top":"2rem"}}),l(h,{cols:"12",style:{position:"sticky",bottom:"-20px","background-color":"white","z-index":"23"}},{default:a(()=>[l(S,{class:"file-picker-pagination",modelValue:o.page,"onUpdate:modelValue":t[2]||(t[2]=g=>o.page=g),"total-rows":o.files.length,"per-page":12},null,8,["modelValue","total-rows"])]),_:1})]),_:1})]),_:1}),l(h,{class:de(["chosen-file-col",{"mobile-show":o.chosenFileColumnShow}]),lg:"4",cols:"12",md:"4",dupa:!0},{default:a(()=>[n.chosenFile.id?(f(),C("div",Ze,[l(s,{class:"close-file-details-icon",onClick:t[3]||(t[3]=g=>o.chosenFileColumnShow=!1),"just-icon":""},{icon:a(()=>[l(r,{icon:"close"})]),_:1}),d("div",Je,[Xe,d("u",{onClick:t[4]||(t[4]=g=>n.deleteFile(n.chosenFile.id)),class:"text-danger",style:{cursor:"pointer"}},"Usuń")]),n.isPhoto(n.chosenFile.type)?(f(),F(m,{key:0,classImg:"img-fluid chosen-img-placeholder",width:"100%",src:n.url(n.chosenFile.path)},null,8,["src"])):x("",!0),l(s,{class:"w-100 mt-2 mb-5",onClick:t[5]||(t[5]=g=>o.modal=!1),color:"success"},{icon:a(()=>[l(r,{class:"check-icon",icon:"check"})]),default:a(()=>[M(" Zatwierdź ")]),_:1}),d("ul",null,[d("li",Qe,[d("a",{target:"_blank",href:n.url(n.chosenFile.path)},[l(s,{class:"white--text",color:o.settings.first_color},{icon:a(()=>[l(r,{icon:"eye"})]),default:a(()=>[et]),_:1},8,["color"])],8,Ye)]),d("li",null,"Nazwa: "+y(n.chosenFile.name),1),d("li",tt," Ścieżka: "+y(n.existingPhotoPath(n.chosenFile.path)),1),d("li",null," Rozmiar: "+y(n.formatFileSize(n.chosenFile.size)),1),n.chosenFile.width?(f(),C("li",it," Szerokość: "+y(n.chosenFile.width)+"px ",1)):x("",!0),n.chosenFile.height?(f(),C("li",nt," Wysokość: "+y(n.chosenFile.height)+"px ",1)):x("",!0),d("li",null,"Typ: "+y(n.chosenFile.type),1),d("li",null," Data utworzenia: "+y(new Date(n.chosenFile.created_at).toLocaleString()),1),d("li",null,[l(s,{onClick:t[6]||(t[6]=g=>n.copyToClipboard(n.url(n.existingPhotoPath(n.chosenFile.path)))),class:"white--text",color:o.settings.first_color},{icon:a(()=>[l(r,{icon:"content-copy"})]),default:a(()=>[ot]),_:1},8,["color"])])])])):x("",!0)]),_:1},8,["class"])])])]),_:1})]),_:1})):D===1?(f(),F(A,{key:1,onLoadFiles:n.loadFiles,"images-only":i.imagesOnly},null,8,["onLoadFiles","images-only"])):x("",!0)]),_:2},1032,["title","active"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})}const at=O(Me,[["render",lt]]),st={props:["tags"],data:()=>({activator:null,attach:null,editing:null,index:-1,menu:!1,model:[],items:[],x:0,search:null,y:0}),methods:{deleteTag(e){this.model.splice(this.model.indexOf(e),1),e.id&&z.delete(`/api/news_tags/delete/${e.id}`)}},watch:{tags(){this.tags&&(this.model=this.tags)},model(e,t){e.length!==t.length&&(this.model=e.map(i=>(typeof i=="string"&&(i={text:i}),i)),this.$emit("tags",this.model))}}},rt={class:"pr-2"};function ct(e,t,i,c,o,n){const m=u("v-icon"),r=u("v-chip"),s=u("v-combobox");return f(),F(s,{modelValue:e.model,"onUpdate:modelValue":t[0]||(t[0]=h=>e.model=h),"hide-no-data":!e.search,"search-input":e.search,"hide-selected":"",label:"Tagi",multiple:"","small-chips":"","append-icon":""},{selection:a(({attrs:h,item:k,parent:S,selected:w})=>[l(r,ue(h,{color:"primary lighten-3","input-value":w,label:"",small:""}),{default:a(()=>[d("span",rt,y(k.text),1),l(m,{small:"",onClick:T=>n.deleteTag(k)},{default:a(()=>[M("mdi-close")]),_:2},1032,["onClick"])]),_:2},1040,["input-value"])]),_:1},8,["modelValue","hide-no-data","search-input"])}const dt=O(st,[["render",ct]]);var ut=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],mt=function(e){return ut.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())!==-1},ft=function(e,t,i){Object.keys(t).filter(mt).forEach(function(c){var o=t[c];typeof o=="function"&&(c==="onInit"?o(e,i):i.on(c.substring(2),function(n){return o(n,i)}))})},ht=function(e,t,i,c){var o=e.modelEvents?e.modelEvents:null,n=Array.isArray(o)?o.join(" "):o;B(c,function(m,r){i&&typeof m=="string"&&m!==r&&m!==i.getContent({format:e.outputFormat})&&i.setContent(m)}),i.on(n||"change input undo redo",function(){t.emit("update:modelValue",i.getContent({format:e.outputFormat}))})},vt=function(e,t,i,c,o,n){c.setContent(n()),i.attrs["onUpdate:modelValue"]&&ht(t,i,c,o),ft(e,i.attrs,c)},Z=0,te=function(e){var t=Date.now(),i=Math.floor(Math.random()*1e9);return Z++,e+"_"+i+Z+String(t)},pt=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},J=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},_t=function(e,t){return J(e).concat(J(t))},gt=function(e){return e==null},X=function(){return{listeners:[],scriptId:te("tiny-script"),scriptLoaded:!1}},yt=function(){var e=X(),t=function(o,n,m,r){var s=n.createElement("script");s.referrerPolicy="origin",s.type="application/javascript",s.id=o,s.src=m;var h=function(){s.removeEventListener("load",h),r()};s.addEventListener("load",h),n.head&&n.head.appendChild(s)},i=function(o,n,m){e.scriptLoaded?m():(e.listeners.push(m),o.getElementById(e.scriptId)||t(e.scriptId,o,n,function(){e.listeners.forEach(function(r){return r()}),e.scriptLoaded=!0}))},c=function(){e=X()};return{load:i,reinitialize:c}},bt=yt(),Ft=function(){return typeof window<"u"?window:global},V=function(){var e=Ft();return e&&e.tinymce?e.tinymce:null},kt={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},j=globalThis&&globalThis.__assign||function(){return j=Object.assign||function(e){for(var t,i=1,c=arguments.length;i<c;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},j.apply(this,arguments)},wt=function(e,t,i,c){return e(c||"div",{id:t,ref:i})},Ct=function(e,t,i){return e("textarea",{id:t,visibility:"hidden",ref:i})},St=me({props:kt,setup:function(e,t){var i=e.init?j({},e.init):{},c=fe(e),o=c.disabled,n=c.modelValue,m=c.tagName,r=he(null),s=null,h=e.id||te("tiny-vue"),k=e.init&&e.init.inline||e.inline,S=!!t.attrs["onUpdate:modelValue"],w=!0,T=e.initialValue?e.initialValue:"",b="",A=function(v){return S?function(){return n!=null&&n.value?n.value:""}:function(){return v?T:b}},P=function(){var v=A(w),p=j(j({},i),{readonly:e.disabled,target:r.value,plugins:_t(i.plugins,e.plugins),toolbar:e.toolbar||i.toolbar,inline:k,setup:function(_){s=_,_.on("init",function(D){return vt(D,e,t,_,n,v)}),typeof i.setup=="function"&&i.setup(_)}});pt(r.value)&&(r.value.style.visibility=""),V().init(p),w=!1};B(o,function(v){var p;s!==null&&(typeof((p=s.mode)===null||p===void 0?void 0:p.set)=="function"?s.mode.set(v?"readonly":"design"):s.setMode(v?"readonly":"design"))}),B(m,function(v){var p;S||(b=s.getContent()),(p=V())===null||p===void 0||p.remove(s),H(function(){return P()})}),ve(function(){if(V()!==null)P();else if(r.value&&r.value.ownerDocument){var v=e.cloudChannel?e.cloudChannel:"6",p=e.apiKey?e.apiKey:"no-api-key",_=gt(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(p,"/tinymce/").concat(v,"/tinymce.min.js"):e.tinymceScriptSrc;bt.load(r.value.ownerDocument,_,P)}}),pe(function(){V()!==null&&V().remove(s)}),k||(_e(function(){w||P()}),ge(function(){var v;S||(b=s.getContent()),(v=V())===null||v===void 0||v.remove(s)}));var E=function(v){var p;b=s.getContent(),(p=V())===null||p===void 0||p.remove(s),i=j(j({},i),v),H(function(){return P()})};return t.expose({rerender:E,getEditor:function(){return s}}),function(){return k?wt(q,h,r,e.tagName):Ct(q,h,r)}}});const xt={components:{editor:St},props:["value"],data(){return{init:{height:500,menubar:!0,plugins:["a11ychecker","advlist","advcode","advtable","autolink","checklist","export","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","powerpaste","fullscreen","formatpainter","insertdatetime","media","table","help","wordcount"],toolbar:"undo redo | casechange blocks | bold italic backcolor |            alignleft aligncenter alignright alignjustify |            bullist numlist checklist outdent indent | removeformat | a11ycheck code table help"}}},watch:{value(){this.$emit("input",this.value)}}};function Pt(e,t,i,c,o,n){const m=u("editor");return f(),F(m,{value:i.value,onInput:t[0]||(t[0]=r=>e.$emit("input",r)),"api-key":"m22xj0x6h1pgqb681evsy9sxvg1fgl2qktcekp6e5ef3ni2z",init:o.init},null,8,["value","init"])}const Vt=O(xt,[["render",Pt]]);const jt={components:{VBtn:N,SvgVue:K}},Tt={class:"form-footer"},zt=d("span",null,"Zatwierdź",-1),Dt=d("span",null,"Anuluj",-1);function Ot(e,t,i,c,o,n){const m=u("svg-vue"),r=u("v-btn");return f(),C("div",Tt,[l(r,{disabled:!e.$store.state.FormService.valid,color:"primary",class:"mr-2",onClick:t[0]||(t[0]=s=>e.$store.commit("FormService/validate"))},{icon:a(()=>[l(m,{icon:"check"})]),default:a(()=>[zt]),_:1},8,["disabled"]),l(r,{color:"error",class:"mr-2",onClick:t[1]||(t[1]=s=>e.$router.go(-1))},{icon:a(()=>[l(m,{icon:"close"})]),default:a(()=>[Dt]),_:1})])}const It=O(jt,[["render",Ot]]),$t={components:{TagsInput:dt,VueEditor:Vt,VTextarea:Te,FilePicker:at,FormFooter:It,VMain:Ce,VCard:R,VCardTitle:Se,VContainer:xe,VForm:ee,VCol:L,VRow:U,TextField:$,Checkbox:Pe,VDivider:we},data(){return{name:"",rules:{titleRules:[e=>!!e||"To pole jest wymagane!"],positiveRules:[e=>e>0||"To pole musi być większe od zera!"],nonNegativeRules:[e=>e>-1||"To pole nie może być ujemne!"],priceRules:[e=>e*1e3%10==0||"To pole musi mieć max. dwa miejsca po przecinku!"],amountRules:[e=>e%1==0||"To pole musi być liczbą całkowitą!"]},activeFile:"",parent:{}}},watch:{validateFlag(e){e&&this.validate()}},computed:{validateFlag(){var e;return((e=this.$store.state.FormService)==null?void 0:e.validateFlag)||!1},valid:{get(){return this.$store.state.FormService.valid},set(e){this.$store.state.FormService.valid=e}},currentObject:{get(){return this.$store.state.FormService.currentObject},set(e){this.$store.commit("FormService/setCurrentObject",e)}},formTitle(){return this.$route.params.id?"Edycja":"Dodawanie"},parentTable(){let e="";return Object.entries(Ve).forEach(t=>{t[1].forEach(i=>{i.tablename==this.$route.path.split("/")[2]&&(e=t[1][0].parent?t[1][0].parent:"")})}),e}},methods:{getUrl:e=>I(e),getParent(){z.get(`/api/${this.parentTable}/get_one/${this.$route.params.parent_id}`).then(e=>this.parent=e.data).catch(e=>console.log(e))},getImageDefaultPlaceholder(){return window.location.origin+"/storage/img/placeholder/250.png"},add(e){this.$store.dispatch("FormService/add",{formData:e})},edit(e,t){this.$store.dispatch("FormService/edit",{formData:e,options:t})},validate(){if(!this.$refs.form.validate()){this.$store.commit("toast","Formularz zawiera błędy!");return}this[this.$route.params.id?"edit":"add"](this.currentObject)},updateDeletedPhoto(){this.$route.params.id&&this.edit(this.currentObject,{redirect:!1})},secureRoutes(){let e=JSON.parse(localStorage.getItem("user")),t=!1;e&&(e.type=="Admin"||e.type=="Moderator")&&(t=!0),t||this.$router.push(`/admin-panel/${this.$route.path.split("/")[2]}`)}},created(){this.$store.hasModule("loading")||this.$store.registerModule("loading",ye),this.$store.hasModule("FormService")||this.$store.registerModule("FormService",je),this.$route.params.id&&z.get(`/api/${this.$route.path.split("/")[2]}/get_one/${this.$route.params.id}`).then(e=>{this.activePhoto=e.data.photo!==null?I(e.data.photo):this.activePhoto,this.activeFile=e.data.file!==null?I(e.data.file):this.activeFile,this.currentObject={...this.currentObject,...e.data}}),this.$route.params.parent_id&&this.getParent(),this.secureRoutes()}};export{$t as F};
