(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"1yF4":function(t,e,n){"use strict";n.r(e);var o=n("vDqi"),a=n.n(o),i=n("WhGA"),r=n("q/Gb");function l(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,i=!0,r=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return i=t.done,t},e:function(t){r=!0,a=t},f:function(){try{i||null==o.return||o.return()}finally{if(r)throw a}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var c={data:function(){return{file:[],loading:!1,valid:!0,rules:[function(t){var e,n=[],o=l(t);try{for(o.s();!(e=o.n()).done;){var a=e.value;a.size>25e6&&n.push(a.name)}}catch(t){o.e(t)}finally{o.f()}return 0===n.length||"Pliki [".concat(n.join(", "),"] nie powinny być większe niż 25 MB!")},function(t){var e,n=[],o=l(t);try{for(o.s();!(e=o.n()).done;){var a=e.value;Object(i.a)(a.type)||n.push(a.name)}}catch(t){o.e(t)}finally{o.f()}return 0===n.length||"Pliki [".concat(n.join(", "),"] powinny być zdjęciami!")}]}},computed:{photoTypes:function(){return r.a.join(", ")},img:function(){return 0==this.file.length?"https://via.placeholder.com/250":URL.createObjectURL(this.file[0])}},methods:{submit:function(){var t=this;if(0!=this.file.length&&this.valid){this.loading=!0;for(var e=0;e<this.file.length;e++){var n=new FormData;n.append("file",this.file[e]),a.a.post("/api/media/add",n).then((function(){t.loading=!1,t.$emit("loadPhotos"),t.file=[],t.$store.commit("setSnackbar","Pomyślnie dodano!")})).catch((function(e){t.loading=!1,console.error(e),t.$store.commit("setSnackbar","Coś poszło nie tak...")}))}}}}},u=n("KHd+"),d=Object(u.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{attrs:{flat:""}},[n("v-card-text",[n("v-row",{staticClass:"d-flex justify-content-center"},[n("v-col",{attrs:{lg:"4",sm:"12",md:"4"}},[n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-file-input",{attrs:{id:"file",multiple:"","show-size":"",counter:"",label:"Zdjęcie",accept:t.photoTypes,"prepend-icon":"mdi-camera",rules:t.rules},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}}),t._v(" "),n("v-btn",{staticClass:"mt-3",attrs:{disabled:t.loading||0===t.file.length,loading:t.loading,color:"success"},on:{click:t.submit}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-check")]),t._v(" "),n("span",[t._v("Wyślij")])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports,h=n("CkU6");function f(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,i=!0,r=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return i=t.done,t},e:function(t){r=!0,a=t},f:function(){try{i||null==o.return||o.return()}finally{if(r)throw a}}}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var v={props:["apiGallery","title"],data:function(){return{dialog:!1,tab:null,tabs:["Wybierz zdjęcia","Dodaj Nowe Zdjęcie"],photos:[],activePhotos:[],multiple:!0,closeIcon:0,placeholder:"/storage/img/placeholder/250.png",search:"",page:1}},components:{AddPhotos:d},watch:{apiGallery:function(){this.loadPhotos(),this.activePhotos=[]}},computed:{filteredPhotos:function(){var t,e=[],n=f(this.photos);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.path.toLowerCase().includes(this.search.toLowerCase())&&e.push(o)}}catch(t){n.e(t)}finally{n.f()}return e.reverse().slice(12*(this.page-1),12*(this.page-1)+12)}},methods:{url:h.a,showCloseIcon:function(t){this.closeIcon=t},isActivePhotoDeleted:function(t){if(null!==this.activePhotoPath){var e,n=f(this.photos);try{for(n.s();!(e=n.n()).done;){var o=e.value;o.id==t&&this.activePhotos.includes(t)&&this.$emit("updateDeletedPhoto",o.path)}}catch(t){n.e(t)}finally{n.f()}}},setApiGallery:function(){var t=this;if(this.apiGallery){for(var e=[],n=function(n){t.apiGallery.some((function(e){return e.path==t.photos[n].path}))||e.includes(t.photos[n])||e.push(t.photos[n])},o=0;o<this.photos.length;o++)n(o);this.photos=e}},loadPhotos:function(){var t=this;a.a.get("/api/media/get_photos").then((function(e){t.photos=e.data,t.setApiGallery()}))},deletePhoto:function(t){var e=this;confirm("Czy na pewno?")&&a.a.delete("/api/media/delete/"+t).then((function(n){e.isActivePhotoDeleted(t),e.loadPhotos()})).catch((function(t){return console.log(t)}))},getPhotoLinks:function(){for(var t=[],e=0;e<this.photos.length;e++)for(var n=0;n<this.activePhotos.length;n++)this.photos[e].id==this.activePhotos[n]&&(t[0]=this.photos[e]);return t},sendImageIdToPlaceholder:function(){var t,e=[],n=f(this.activePhotos);try{for(n.s();!(t=n.n()).done;){var o=t.value;e.push(this.getPhotoById(o))}}catch(t){n.e(t)}finally{n.f()}this.$emit("loadedImage",e)},setPhotoClass:function(t){this.activePhotos.includes(t)?this.activePhotos.splice(this.activePhotos.indexOf(t),1):this.activePhotos.push(t),this.sendImageIdToPlaceholder()},getPhotoById:function(t){for(var e=0;e<this.photos.length;e++)if(this.photos[e].id==t)return this.photos[e].path}},created:function(){this.loadPhotos()}},m=(n("w6NR"),Object(u.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-row",[n("v-row",{staticClass:"mt-5 mb-2 px-3 gallery-picker",attrs:{justify:"center"}},[n("v-dialog",{staticStyle:{"background-color":"white !important"},attrs:{persistent:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({staticClass:"w-100",attrs:{color:"primary",dark:""}},"v-btn",a,!1),o),[t._v("\n          "+t._s(t.title||"Dodaj galerię")+"\n        ")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[t._v(" "),n("v-card",[n("div",{staticClass:"gallery-picker-menu"},[n("v-card-title",{staticClass:"d-flex justify-content-between position-relative"},[n("div",{staticClass:"d-flex align-items-center flex-wrap"},[n("div",[t._v("GalleryPicker")]),t._v(" "),n("div",{staticClass:"ml-3"},[n("v-text-field",{attrs:{label:"Szukaj","prepend-icon":"mdi-magnify"},on:{change:t.searchPhoto},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]),t._v(" "),n("v-icon",{staticClass:"gallery-picker-close",on:{click:function(e){t.dialog=!1}}},[t._v("mdi-close")])],1),t._v(" "),n("v-tabs",{attrs:{"background-color":"primary",dark:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.tabs,(function(e){return n("v-tab",{key:e},[t._v("\n              "+t._s(e)+"\n            ")])})),1)],1),t._v(" "),n("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[n("v-tab-item",[n("v-card",{attrs:{flat:""}},[n("v-card-text",[n("v-container",[n("v-row",{staticClass:"d-flex align-items-center"},[t._l(t.filteredPhotos,(function(e){return n("v-col",{key:e.id,staticClass:"d-flex align-items-between flex-column",attrs:{lg:"2",md:"3",cols:"6",sm:"4"},on:{mouseout:function(e){t.closeIcon=0},mouseover:function(n){return t.showCloseIcon(e.id)}}},[n("div",{staticClass:"d-flex justify-content-end"},[n("v-icon",{staticClass:"close-icon",attrs:{color:t.closeIcon==e.id?"black":"white"},on:{click:function(n){return t.deletePhoto(e.id)}}},[t._v("mdi-close")])],1),t._v(" "),n("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(o){var a=o.on,i=o.attrs;return[n("div",t._g(t._b({staticClass:"position-relative",on:{click:function(n){return t.setPhotoClass(e.id)}}},"div",i,!1),a),[t.activePhotos.includes(e.id)?n("div",{staticClass:"mask gallery-picker-photo-mask"}):t._e(),t._v(" "),n("img",{staticClass:"gallery-picker-photo",attrs:{loading:"lazy",src:t.url(e.path)}})])]}}],null,!0)},[t._v(" "),n("span",[t._v(t._s(e.path))])])],1)})),t._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-pagination",{staticClass:"file-picker-pagination",attrs:{length:Math.ceil(t.photos.length/12)},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)],2)],1)],1)],1)],1),t._v(" "),n("v-tab-item",[n("AddPhotos",{on:{loadPhotos:t.loadPhotos}})],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports),y=n("O5ec");function g(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||k(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=k(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,i=!0,r=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return i=t.done,t},e:function(t){r=!0,a=t},f:function(){try{i||null==o.return||o.return()}finally{if(r)throw a}}}}function k(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var w={components:{GalleryPicker:m},data:function(){return{name:"",rules:{titleRules:[function(t){return!!t||"Tytuł jest wymagany!"}]},apiGallery:[],pickedGallery:[],gallery:[],currentObject:{},activePhoto:"https://via.placeholder.com/250",img:""}},computed:{formTitle:function(){return"players"==this.$route.path.split("/")[2]?"".concat(this.currentObject.first_name," ").concat(this.currentObject.last_name):this.currentObject.title}},methods:{getUrl:function(t){return Object(h.a)(t)},getImageDefaultPlaceholder:function(){return"https://via.placeholder.com/250"},setGallery:function(t){var e,n=[],o=b(t);try{for(o.s();!(e=o.n()).done;){var a=e.value;n.push({path:a,photo_alt:"",item_id:this.$route.params.id,table_name:this.$route.params.table})}}catch(t){o.e(t)}finally{o.f()}this.pickedGallery=n,this.gallery=[].concat(g(this.apiGallery),g(this.pickedGallery))},setImagePlaceholder:function(t){"placeholder"===t?(this.img="",this.activePhoto=this.getImageDefaultPlaceholder()):(this.setGallery(t),this.activePhoto=Object(h.a)(t))},getFormData:function(){return this.gallery},resetForm:function(){this.activePhoto=this.getImageDefaultPlaceholder()},setLoading:function(t){this.$store.commit("loading",t)},add:function(t){var e=this;a.a.post("/api/gallery/add",t,{headers:{"Content-Type":"application/json"}}).then((function(t){e.setLoading(!1),e.$store.commit("setSnackbar",y.a.success),e.loadGallery(),e.resetForm()})).catch((function(t){e.$store.commit("setSnackbar",y.a.error),e.setLoading(!1)}))},edit:function(t){var e=this;a.a.put("/api/gallery/edit",t,{headers:{"Content-Type":"application/json"}}).then((function(t){e.setLoading(!1),e.$store.commit("setSnackbar",y.a.success),e.loadGallery()})).catch((function(t){e.$store.commit("setSnackbar",y.a.error),e.setLoading(!1),console.log(t)}))},destroy:function(t){var e=this;confirm("Czy na pewno chcesz usunąć to zdjęcie z galerii?")&&(this.setLoading(!0),a.a.delete("/api/gallery/delete/"+t).then((function(t){e.setLoading(!1),e.$store.commit("setSnackbar",y.a.success),e.loadGallery()})).catch((function(t){e.$store.commit("setSnackbar",y.a.error),e.setLoading(!1),console.log(t)})))},send:function(){this.getFormData().length>0&&this.setLoading(!0);var t,e=b(this.getFormData());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.id?this.edit(n):this.add(n)}}catch(t){e.e(t)}finally{e.f()}},updateDeletedPhoto:function(t){this.gallery.splice(this.gallery.findIndex((function(e){return e.path==t})))},loadCurrentObject:function(){var t=this;a.a.get("/api/".concat(this.$route.path.split("/")[2],"/get_one/").concat(this.$route.params.id)).then((function(e){t.currentObject=e.data}))},loadGallery:function(){var t=this;a.a.get("/api/gallery/get_photos/".concat(this.$route.path.split("/")[2],"/").concat(this.$route.params.id)).then((function(e){t.apiGallery=e.data,t.gallery=e.data,t.setLoading(!1)}))}},created:function(){"realizations"!=this.$route.path.split("/")[2]&&this.loadCurrentObject(),this.loadGallery(),this.setLoading(!0)}},P=(n("t9Rn"),Object(u.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-content",{},[n("v-container",[n("v-card",[n("v-card-title",{staticClass:"justify-content-center"},["undefined undefined"!=t.formTitle?n("h2",{staticClass:"pt-4 font-weight-bold panel-title-header first-color"},[t._v("\n          "+t._s("realizations"==t.$route.path.split("/")[2]?"Realizacje":"Galeria - "+t.formTitle)+"\n        ")]):t._e()]),t._v(" "),n("v-divider",{staticClass:"mt-0"}),t._v(" "),n("v-form",{ref:"form"},[n("v-row",[n("v-col",{attrs:{cols:"12",md:"8"}},[n("div",{staticClass:"pa-5"},[n("div",{staticClass:"gallery-container"},[n("v-row",t._l(t.gallery,(function(e){return n("v-col",{key:e.path,attrs:{cols:"12",sm:"6",md:"4"}},[n("div",{staticClass:"position-relative"},[n("img",{staticClass:"img-fluid",attrs:{src:t.getUrl(e.path),alt:""}}),t._v(" "),n("div",{staticClass:"close-icon-container"},[e.id?n("v-icon",{staticClass:"pr-1 pt-1 close-icon",attrs:{color:"grey"},on:{click:function(n){return t.destroy(e.id)}}},[t._v("mdi-close")]):t._e()],1)]),t._v(" "),n("v-text-field",{attrs:{label:"Tekst alternatywny"},model:{value:e.photo_alt,callback:function(n){t.$set(e,"photo_alt",n)},expression:"photo.photo_alt"}})],1)})),1)],1)])]),t._v(" "),n("v-col",{attrs:{cols:"12",md:"4"}},[n("div",{staticClass:"pa-5 d-flex flex-column justify-content-between"},[n("div",[n("GalleryPicker",{attrs:{apiGallery:t.apiGallery},on:{updateDeletedPhoto:t.updateDeletedPhoto,loadedImage:t.setImagePlaceholder}})],1)])])],1),t._v(" "),n("v-divider",{staticClass:"mb-0"}),t._v(" "),n("v-card-actions",{staticClass:"pa-4"},[n("v-btn",{staticClass:"mr-2",attrs:{disabled:0===t.gallery.length,color:"primary"},on:{click:t.send}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-check")]),t._v(" "),n("span",[t._v("Zatwierdź")])],1),t._v(" "),n("v-btn",{staticClass:"mr-2",attrs:{color:"error"},on:{click:function(e){return t.$router.go(-1)}}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-close")]),t._v(" "),n("span",[t._v("Anuluj")])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null));e.default=P.exports},"40QK":function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,".gallery-picker-menu {\n  position: -webkit-sticky;\n  position: sticky;\n  width: 100%;\n  z-index: 1;\n  background: white;\n  top: 0;\n}\n@media (max-width: 992px) {\n.gallery-picker-menu {\n    position: -webkit-sticky;\n    position: sticky;\n    width: unset;\n}\n}\n.gallery-picker-photo {\n  cursor: pointer;\n  height: auto;\n  width: 100%;\n}\n.gallery-picker-photo-mask {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n  background-color: var(--first-color);\n  opacity: 0.7;\n  cursor: pointer;\n  filter: drop-shadow(2px 4px 6px black);\n}\n.gallery-picker-close {\n  position: absolute !important;\n  top: 14%;\n  right: 2%;\n}\n.v-dialog {\n  background-color: white !important;\n}",""])},Bgio:function(t,e,n){var o=n("40QK");"string"==typeof o&&(o=[[t.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(o,a);o.locals&&(t.exports=o.locals)},t9Rn:function(t,e,n){"use strict";n("xbAz")},tVJg:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,"\n.gallery-form-photo {\r\n  background-size: cover;\r\n  width: 100%;\r\n  height: auto;\r\n  margin: auto;\n}\n.close-icon {\r\n  /*filter: invert(1);*/\n}\n.close-icon-container {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  align-items: flex-start;\n}\r\n",""])},w6NR:function(t,e,n){"use strict";n("Bgio")},xbAz:function(t,e,n){var o=n("tVJg");"string"==typeof o&&(o=[[t.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(o,a);o.locals&&(t.exports=o.locals)}}]);
//# sourceMappingURL=cms~cms9.js.map